<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satellite 신청곡 리스트 (자동 로딩)</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; padding: 20px; background-color: #f4f7f9; }
        .container { max-width: 1200px; margin: 0 auto; }
        h2 { text-align: center; color: #2c3e50; }
        #status { text-align: center; color: #666; margin-bottom: 20px; font-weight: bold; }
        
        .search-container { margin-bottom: 25px; text-align: center; position: sticky; top: 0; background: #f4f7f9; padding: 10px 0; z-index: 100; }
        #searchInput { width: 90%; max-width: 600px; padding: 15px; border: 2px solid #ddd; border-radius: 30px; outline: none; font-size: 16px; }

        .table-wrapper { background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); overflow: hidden; }
        table { width: 100%; border-collapse: collapse; }
        th { background-color: #4A90E2; color: white; padding: 15px; text-align: left; }
        td { padding: 12px 15px; border-bottom: 1px solid #eee; font-size: 14px; }
        tr:hover { background-color: #f9fcff; }
        .center { text-align: center; }
        .lv-tag { display: inline-block; padding: 2px 8px; border-radius: 4px; font-weight: bold; background: #eee; }
    </style>
</head>
<body>

<div class="container">
    <h2>Satellite 신청곡 전체 리스트</h2>
    <p id="status">Satellite.html 파일을 읽어오는 중...</p>

    <div class="search-container">
        <input type="text" id="searchInput" placeholder="곡명, 아티스트, 레벨로 검색...">
    </div>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th class="center" style="width: 60px;">No.</th>
                    <th class="center" style="width: 80px;">LV</th>
                    <th>TITLE</th>
                    <th>ARTIST</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>
</div>

<script>
    let songData = [];

    // 1. Satellite.html 파일을 읽어와서 파싱하는 함수
    async function loadSatelliteData() {
        try {
            const response = await fetch('Satellite.html'); // 같은 폴더의 파일 호출
            const text = await response.text();
            const parser = new DOMParser();
            const doc = parser.parseFromString(text, 'text/html');
            
            // 원본 파일의 테이블 행들 추출
            const rows = Array.from(doc.querySelectorAll('#table_int tr')).slice(2);
            
            songData = rows.map(row => {
                const tds = row.querySelectorAll('td');
                if (tds.length < 3 || row.classList.contains('tr_separate')) return null;
                return {
                    lv: tds[0].innerText.trim(),
                    title: tds[1].innerText.trim(),
                    artist: tds[2].innerText.trim()
                };
            }).filter(item => item !== null);

            document.getElementById('status').innerText = `총 ${songData.length}곡 로드 완료!`;
            renderTable(songData);
        } catch (error) {
            document.getElementById('status').innerText = "파일을 불러오지 못했습니다. Satellite.html이 같은 곳에 있는지 확인해주세요.";
            console.error(error);
        }
    }

    // 2. 표 그리기 함수
    function renderTable(data) {
        const tableBody = document.getElementById('tableBody');
        tableBody.innerHTML = data.map((s, i) => `
            <tr>
                <td class="center" style="color:#999;">${i + 1}</td>
                <td class="center"><span class="lv-tag">${s.lv}</span></td>
                <td><b>${s.title}</b></td>
                <td style="color:#666;">${s.artist}</td>
            </tr>
        `).join('');
    }

    // 3. 검색 기능
    document.getElementById('searchInput').addEventListener('keyup', (e) => {
        const query = e.target.value.toLowerCase();
        const filtered = songData.filter(s => 
            s.title.toLowerCase().includes(query) || 
            s.artist.toLowerCase().includes(query) || 
            s.lv.toLowerCase().includes(query)
        );
        renderTable(filtered);
        document.getElementById('status').innerText = `검색 결과: ${filtered.length}곡`;
    });

    // 실행
    loadSatelliteData();
</script>

</body>
</html>